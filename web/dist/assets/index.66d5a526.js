import{r as p,b as r,A as Q,w as I,t as f,R as J,F as h,c as U,j as i,a as C,I as T,U as y,M as K,bx as D,by as B,B as N,aE as W,d as Y,q as ee,k as P,y as te,T as ne}from"./index.d8d91588.js";import{T as re}from"./select_input.a4e8b1c9.js";import{T as V,D as ae}from"./index.93d02781.js";import{P as oe}from"./PlusOutlined.16a4ec92.js";import{T as ie}from"./index.a843e620.js";import{C as le}from"./index.9a22fd67.js";import"./index.ec907f20.js";import"./iconUtil.3e86a04f.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};const ce=se;var ue=function(e,t){return r(Q,{...e,ref:t,icon:ce})};const de=p.exports.forwardRef(ue),pe={base:{prefix:"dropdown/organization",endpoints:{crud:"",getTree:"getTree"}}},E=I.prefixMapValues(pe.base),ge=f.exports.t`Quản lý tổ chức Đoàn`,$="t\u1ED5 ch\u1EE9c \u0110o\xE0n",q={heading:ge,name:$,deleteOne:f.exports.t`Do you want to remote this ${$}?`,deleteMultiple:f.exports.t`Do you want to remote these ${$}?`},v={id:0,cover_image:"",title:"",organization_category_ids:void 0,organization_type:"",created_at:"",created_by:"",status:1,content:""},m={parent_label:f.exports.t`Đơn vị cấp trên`,title:f.exports.t`Tên tổ chức đoàn`,type:f.exports.t`Loại tổ chức`,level:f.exports.t`Cấp tổ chức`,rep_name:f.exports.t`Người đại diện`,rep_email:f.exports.t`Email`,rep_mobile:f.exports.t`Số điện thoại`};function me(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function H(n){return function e(t){return arguments.length===0||me(t)?e:n.apply(this,arguments)}}function fe(n){return new RegExp(n.source,(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":""))}var he=H(function(e){return e===null?"Null":e===void 0?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});const ye=he;function X(n,e,t,a){var o=function(d){for(var u=e.length,c=0;c<u;){if(n===e[c])return t[c];c+=1}e[c]=n,t[c]=d;for(var s in n)n.hasOwnProperty(s)&&(d[s]=a?X(n[s],e,t,!0):n[s]);return d};switch(ye(n)){case"Object":return o(Object.create(Object.getPrototypeOf(n)));case"Array":return o([]);case"Date":return new Date(n.valueOf());case"RegExp":return fe(n);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return n.slice();default:return n}}var be=H(function(e){return e!=null&&typeof e.clone=="function"?e.clone():X(e,[],[],!0)});const xe=be,F=J({key:"organizationOptions",default:{}}),R="OrganizationForm";function w({data:n,onChange:e,isDepartment:t,parent:a={}}){const o=p.exports.useRef(null),[l]=h.useForm(),d=U(F),u=xe({...n});u.type||(u.type=d.type[0].value),u.level||(u.level=d.level[0].value),u.parent_label=a.label;const c=u.id,s=c?`${E.crud}${c}`:E.crud,b=c?"put":"post",g={parent_label:{name:"parent_label",label:m.parent_label},title:{name:"title",label:m.title},type:{name:"type",label:m.type},level:{name:"level",label:m.level},rep_name:{name:"rep_name",label:m.rep_name},rep_email:{name:"rep_email",label:m.rep_email},rep_mobile:{name:"rep_mobile",label:m.rep_mobile}};return p.exports.useEffect(()=>{o.current.focus({cursor:"end"})},[]),i(h,{form:l,name:R,labelCol:{span:8},wrapperCol:{span:16},initialValues:{...u},onFinish:x=>C.submit(s,{...x,parent:a.value,is_department:t},b).then(S=>e(S,c)).catch(C.setFormErrors(l)),children:[r(h.Item,{...g.title,children:r(T,{ref:o})}),r(h.Item,{...g.type,children:r(re,{options:d.type,block:!0,blankLabel:m.type})}),u.parent_label&&r(h.Item,{...g.parent_label,children:r(T,{disabled:!0})}),r(h.Item,{...g.rep_email,children:r(T,{})}),r(h.Item,{...g.rep_mobile,children:r(T,{})}),r(h.Item,{...g.rep_name,children:r(T,{})})]})}w.displayName=R;w.formName=R;class O{static get toggleEvent(){return"TOGGLE_ORGANIZATION_DIALOG"}static toggle(e=!0,t=0,a={}){y.event.dispatch(O.toggleEvent,{open:e,id:t,parent:a})}}function A({onChange:n}){const[e,t]=p.exports.useState({...v}),[a,o]=p.exports.useState(!1),[l,d]=p.exports.useState(0),[u,c]=p.exports.useState({}),s=({detail:{open:g,id:x,parent:S}})=>{if(!g)return o(!1);d(x),x?(y.toggleGlobalLoading(),I.apiCall(`${E.crud}${x}`).then(G=>{t(G),c(G.parent_obj),o(!0)}).finally(()=>y.toggleGlobalLoading(!1))):(t({...v}),c(S||{}),o(!0))};p.exports.useEffect(()=>(y.event.listen(O.toggleEvent,s),()=>{y.event.remove(O.toggleEvent,s)}),[]);const b=()=>l?"S\u1EEDa t\u1ED5 ch\u1EE9c \u0110o\xE0n":"Th\xEAm t\u1ED5 ch\u1EE9c \u0110o\xE0n c\u1EA5p d\u01B0\u1EDBi.";return r(K,{keyboard:!1,maskClosable:!1,destroyOnClose:!0,open:a,okButtonProps:{form:w.formName,key:"submit",htmlType:"submit"},okText:"OK",onCancel:()=>O.toggle(!1),cancelText:"Tho\xE1t",title:b(),children:r(w,{data:e,parent:u,onChange:(g,x)=>{o(!1),n(g,x)}})})}A.displayName="OrganizationDialog";A.toggle=O.toggle;class k{static responseIntercept(){D.defaults.withCredentials=!1,D.defaults.xsrfHeaderName="X-CSRFToken",D.defaults.xsrfCookieName="csrftoken"}static getValueFromEvent(e){return e.target.value||""}static getCheckedFromEvent(e){return!!e.target.checked||!1}static removeEmptyKey(e={}){const t={};for(const[a,o]of Object.entries(e))k.isBlank(o)&&(t[a]=o);return t}static isBlank(e){return typeof e!="number"&&!e}static appendKey(e,t=0,a=0){return e.map((o,l)=>(o.id!==void 0?o.key=o.id:o.key=l,o.index=(t-1)*a+l+1,o))}static isEmpty(e){return e?Object.keys(e).length===0&&e.constructor===Object:!0}static appendIdForGroupOptions(e){return e.map(t=>(t.options=t.options.map(a=>(a.value=[t.value,a.value].join("|"),a)),t))}static getDialogTitle(e,t){const a=e?f.exports.t`Update`:f.exports.t`Add new`,o=t.name.toLowerCase();return`${a} ${o}`}static strToDate(e){try{return new Date(e)}catch{return null}}static dateFormat(e){if(!e)return e;e.includes("T")&&(e=e.split("T")[0]);try{return e.split("-").reverse().join("/")}catch{return e}}static isoToReadableDatetimeStr(e){if(!e||!e.includes("T"))return e;const t=e.split("T");let a=t[0],o=t[1];try{return a=a.split("-").reverse().join("/"),o=o.split(":"),o.pop(),o=o.join(":"),a+" "+o}catch{return e}}static dateStrReadableToIso(e){return e.split("/").reverse().join("-")}static ensurePk(e){return e=String(e),e.includes("_")?parseInt(e.split("_")[1]):parseInt(e)}static get event(){return{listen:(e,t)=>{window.document.addEventListener(e,t,!1)},remove:(e,t)=>{window.document.removeEventListener(e,t,!1)},dispatch:(e,t)=>{const a=new CustomEvent(e,{detail:t});window.document.dispatchEvent(a)}}}static toggleGlobalLoading(e=!0){k.event.dispatch("TOGGLE_SPINNER",e)}static timeAgo(e){if(e){const t=Math.floor((+new Date-+new Date(e))/1e3);if(t<=60)return"g\u1EA7n \u0111\xE2y";const a={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};if(t>a.minute&&t<a.hour)return Math.floor(t/a.minute)+" ph\xFAt tr\u01B0\u1EDBc";if(t>a.hour&&t<a.day)return Math.floor(t/a.hour)+" gi\u1EDD tr\u01B0\u1EDBc";if(t>a.day&&t<a.week)return Math.floor(t/a.day)+" ng\xE0y tr\u01B0\u1EDBc";if(t>a.week)return this.date.transform(new Date(e*1e3),"dd/MM/yyyy")}return e}}class Ee{static parseInput(e,t=null){return[t?`${t}_${e}`:`${e}`]}}function ve({options:n,value:e,level:t=null,onChange:a}){function o(l){a(k.ensurePk(l))}return r(V,{defaultExpandAll:!0,autoExpandParent:!0,showLine:!0,defaultSelectedKeys:Ee.parseInput(e,t),onSelect:o,treeData:n})}const L="OrganizationMovingForm";function z({id:n,onChange:e}){const[t]=h.useForm(),a=U(F),o={parent:{name:"parent",label:"Ph\xF2ng ban",rules:[C.ruleRequired()]}};return r(h,{form:t,name:L,labelCol:{span:6},wrapperCol:{span:18},initialValues:{parent:n},onFinish:l=>C.submit(`${E.crud}${n}`,l,"put").then(()=>e()).catch(C.setFormErrors(t)),children:r(h.Item,{...o.parent,children:r(ve,{options:a,level:"department"})})})}z.displayName=L;z.formName=L;class _{static get toggleEvent(){return"TOGGLE_ORGANIZATION_MOVING_DIALOG"}static toggle(e=!0,t=0){y.event.dispatch(_.toggleEvent,{open:e,id:t})}}function M({onChange:n}){const[e,t]=p.exports.useState(!1),[a,o]=p.exports.useState(0),l=({detail:{open:u,id:c}})=>{if(!u)return t(!1);o(c),setTimeout(()=>t(!0),200)};p.exports.useEffect(()=>(y.event.listen(_.toggleEvent,l),()=>{y.event.remove(_.toggleEvent,l)}),[]);const d="Di chuy\u1EC3n \u0111\u1EBFn";return r(K,{keyboard:!1,maskClosable:!1,destroyOnClose:!0,open:e,okButtonProps:{form:z.formName,key:"submit",htmlType:"submit"},okText:"OK",onCancel:()=>_.toggle(!1),cancelText:"Tho\xE1t",title:d,children:r(z,{id:a,onChange:()=>{t(!1),n()}})})}M.displayName="OrganizationMovingDialog";M.toggle=_.toggle;function Z({item:n,onChange:e}){const t=a=>{!window.confirm(q.deleteOne)||(y.toggleGlobalLoading(!0),I.apiCall(`${E.crud}${a}`,{},"delete").then(()=>{e(null)}).finally(()=>y.toggleGlobalLoading(!1)))};return n.id?i("div",{children:[r("table",{children:i("tbody",{children:[i("tr",{children:[i("td",{children:[i("strong",{children:[m.title,":"]}),"\xA0"]}),r("td",{children:n.title})]}),i("tr",{children:[i("td",{children:[i("strong",{children:[m.type,":"]}),"\xA0"]}),r("td",{children:n.type_obj.label})]}),i("tr",{children:[i("td",{children:[i("strong",{children:[m.rep_name,":"]}),"\xA0"]}),r("td",{children:n.rep_name})]}),i("tr",{children:[i("td",{children:[i("strong",{children:[m.rep_email,":"]}),"\xA0"]}),r("td",{children:n.rep_email})]}),i("tr",{children:[i("td",{children:[i("strong",{children:[m.rep_mobile,":"]}),"\xA0"]}),r("td",{children:n.rep_mobile})]})]})}),r(B,{}),i("div",{children:[r(N,{icon:r(W,{}),onClick:()=>A.toggle(!0,n.id),children:"S\u1EEDa"}),"\xA0",r(N,{icon:r(ae,{}),onClick:()=>t(n.id),children:"Xo\xE1"})]}),r(B,{}),r(N,{type:"primary",icon:r(oe,{}),onClick:()=>A.toggle(!0,0,{value:n.id,label:n.title}),children:"Th\xEAm t\u1ED5 ch\u1EE9c \u0110o\xE0n c\u1EA5p d\u01B0\u1EDBi"}),"\xA0"]}):null}Z.displayName="OrganizationPreview";function j(){const n=Y(F),[e,t]=p.exports.useState([]),[a,o]=p.exports.useState(v),l=(s="",b={})=>{I.apiCall(s||E.crud,b).then(g=>{t(g.items),n(g.extra.options)})};p.exports.useEffect(()=>{l()},[]);function d(s,b){o(b?s===null?v:s:v),l()}function u(){o(v),l()}return i("div",{children:[i(ee,{children:[i(P,{span:6,children:[r("div",{children:i(ie,{children:[r(de,{})," Click v\xE0o th\xF4ng tin t\u1ED5 ch\u1EE9c \u0111\u1EC3 xem chi ti\u1EBFt"]})}),r(V,{showLine:!0,onSelect:([s])=>{!s||I.apiCall(`${E.crud}${y.ensurePk(s)}`).then(b=>{o(b)})},treeData:e,titleRender:s=>r("a",{children:s.title})})]}),r(P,{span:18,children:r(Z,{item:a,onChange:d})})]}),r(A,{onChange:d}),r(M,{onChange:u})]})}j.displayName="OrganizationTable";j.displayName="OrganizationTable";const{Title:Oe}=ne;function _e(){return r(le,{title:r(()=>r(te,{size:12,children:r(Oe,{level:5,style:{marginBottom:0},children:q.heading})}),{}),children:r(j,{})})}_e.displayName="Organization";export{_e as default};
