import{e as O,F as l,c as P,r as E,U as F,a as c,j as u,x as T,b as e,y as _,B as h,bz as H,N as X,bw as M,w as Q,T as Y}from"./index.d8d91588.js";import{U as J}from"./upload_file_util.e2f31e55.js";import{T as v}from"./select_input.a4e8b1c9.js";import{F as f}from"./index.59abc101.js";import{n as K,e as W,u as I,l as r,m as Z}from"./states.e29b37a1.js";import{I as q,C as ee}from"./ckeditor.a2057d7b.js";import{D as w}from"./date_input.10280a27.js";import{C as te}from"./index.9a22fd67.js";import"./index.ec907f20.js";import"./index.f77f15be.js";import"./CalendarOutlined.3e9bb1c6.js";import"./PlusOutlined.16a4ec92.js";const x="newForm";function A({data:n,onChange:k}){const y=O(),b=X.navigateTo(y),[s]=l.useForm(),d=P(K),[o,V]=E.exports.useState({cover_image:"",images:[],files:[]}),p=t=>{V(i=>({...i,...t})),s.setFieldsValue({...s.getFieldValue(),...t})},U=t=>{let i=t.path;s.setFieldsValue({...s.getFieldValue(),cover_image:i}),p({cover_image:i})},D=(t,i)=>{let m=o.images;m.splice(t,1),p({images:m})},N=(t,i)=>{let m=o.files;m.splice(t,1),p({files:m})};E.exports.useEffect(()=>{s.setFieldsValue({...s.getFieldValue(),...n}),p({cover_image:n.cover_image||"",images:n.images||[],files:n.files||[]})},[n]);const R=F.isEmpty(n)?W:{...n},g=R.id,B=g?`${I.crud}${g}`:I.crud,L=g?"put":"post";let{beneficiaries:S,types:j}=d;const a={title:{name:"title",label:r.title,rules:[c.ruleRequired()]},type:{name:"type",label:r.type,rules:[c.ruleRequired()]},occurring_time:{name:"occurring_time",label:r.occurring_time,rules:[c.ruleRequired()]},registration_from:{name:"registration_from",label:r.registration_from,rules:[c.ruleRequired()]},registration_to:{name:"registration_to",label:r.registration_to,rules:[c.ruleRequired()]},place:{name:"place",label:r.place,rules:[c.ruleRequired()]},beneficiary_types:{name:"beneficiary_types",label:r.beneficiary_types,rules:[c.ruleRequired()]},cover_image:{name:"cover_image",label:r.cover_image,rules:[c.ruleRequired()]},images:{name:"images",label:r.images},files:{name:"files",label:r.files},content:{name:"content",label:r.content,rules:[c.ruleRequired()]},contact_mobile:{name:"contact_mobile",label:r.contact_mobile},contact_email:{name:"contact_email",label:r.contact_email},status:{name:"status",label:r.status,rules:[c.ruleRequired()]}},z=t=>{let i=o.images;i=[...i,{campaign:n.id,url:t.path,title:t.file_name,type:1}],s.setFieldsValue({...s.getFieldValue(),images:i}),p({images:i})},$=t=>{let i=o.files;i=[...i,{campaign:n.id,url:t.path,title:t.file_name,type:2}],s.setFieldsValue({...s.getFieldValue(),files:i}),p({files:i})},C=t=>{J.upload("*","task",t)},G=()=>{b("/activity/campaign/")};return u(l,{form:s,name:x,labelCol:{span:3},labelAlign:"left",wrapperCol:{span:21},requiredmarkposition:"right",initialValues:{...R},onFinish:t=>c.submit(B,t,L).then(i=>{T.success({message:(g?"Ch\u1EC9nh s\u1EEDa":"Th\xEAm m\u1EDBi")+" \u0111\u1EE3t t\xECnh nguy\u1EC7n th\xE0nh c\xF4ng",duration:8}),b("/activity/campaign/")}).catch(i=>{T.error({message:(g?"Ch\u1EC9nh s\u1EEDa":"Th\xEAm m\u1EDBi")+" \u0111\u1EE3t t\xECnh nguy\u1EC7n th\u1EA5t b\u1EA1i",duration:8})}),children:[e(l.Item,{...a.title,children:e(f,{})}),e(l.Item,{...a.type,children:e(v,{block:!0,options:j})}),e(l.Item,{...a.cover_image,children:u(_,{size:12,children:[e(h,{onClick:()=>C(U),children:"T\u1EA3i \u1EA3nh l\xEAn"}),e("div",{style:{width:150},children:e(q,{type:"thumbnail",url:o.cover_image})})]})}),e(l.Item,{...a.registration_from,children:e(w,{})}),e(l.Item,{...a.registration_to,children:e(w,{})}),e(l.Item,{...a.occurring_time,children:e(f,{})}),e(l.Item,{...a.place,children:e(f,{})}),e(l.Item,{...a.beneficiary_types,children:e(v,{block:!0,options:S,mode:"multiple",allowClear:!0})}),e(l.Item,{...a.content,children:e(ee,{})}),e(l.Item,{...a.images,children:u(_,{size:12,children:[e(h,{onClick:()=>C(z),children:"T\u1EA3i \u1EA3nh l\xEAn"}),o.images.map((t,i)=>u("div",{style:{width:150},children:[e(q,{type:"thumbnail",url:t.url}),e("div",{style:{marginTop:8,display:"flex",justifyContent:"center"},children:e("a",{onClick:m=>D(i),style:{color:"red"},children:"Xo\xE1"})})]}))]})}),e(l.Item,{...a.files,children:u(_,{size:12,children:[e(h,{onClick:()=>C($),children:"T\u1EA3i t\xE0i li\u1EC7u"}),e("div",{children:o.files.map((t,i)=>u("div",{children:[e("a",{href:t.url,children:t.title})," ",e("a",{onClick:m=>N(i),style:{color:"red",marginLeft:8},children:"Xo\xE1"})]}))})]})}),e(l.Item,{...a.contact_mobile,children:e(f,{})}),e(l.Item,{...a.contact_email,children:e(f,{})}),e(l.Item,{...a.status,children:e(v,{block:!0,options:H})}),u("div",{style:{width:"100%",display:"flex",justifyContent:"end",gap:10},children:[e(h,{onClick:G,children:"Quay l\u1EA1i"}),e(h,{type:"primary",htmlType:"submit",children:"L\u01B0u"})]})]})}A.displayName=x;A.formName=x;const{Title:ie}=Y;function he(){const{id:n}=M(),[k,y]=E.exports.useState({});E.exports.useEffect(()=>{b(n)},[n]);const b=d=>{d!="0"?(F.toggleGlobalLoading(),Q.apiCall(`${I.crud}${d}`).then(o=>{y(o)}).finally(()=>F.toggleGlobalLoading(!1))):y({})};return e(te,{title:e(()=>e(_,{size:12,children:e(ie,{level:5,style:{marginBottom:0},children:Z.heading})}),{}),children:e(A,{data:k,onChange:(d,o)=>{setOpen(!1),onChange(d,o)}})})}export{he as default};
